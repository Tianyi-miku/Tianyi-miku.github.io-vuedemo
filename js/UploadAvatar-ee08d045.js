import{bC as e,bD as o,bE as a,_ as t,w as i,o as s,a as l,b as n,z as r,B as d,n as p,H as u,bg as c,bh as f,I as h,K as m,aF as g,N as v,O as C}from"./vendors-a4d7b1d1.js";import{f as b,h as L}from"./index-73cd413b.js";var _={props:["defaultAvatar"],components:{CloudUploadOutlined:e,PlusOutlined:o,VueCropper:a},data(){return{visible:!1,id:null,confirmLoading:!1,fileList:[],uploading:!1,options:{img:this.defaultAvatar||"/DNAPic/avatar.jpg",upLoadedAvatar:this.defaultAvatar||"/DNAPic/avatar.jpg",info:!0,size:1,outputType:"jpeg",canScale:!1,autoCrop:!0,autoCropWidth:180,autoCropHeight:180,fixedBox:!0,fixed:!0,fixedNumber:[1,1]},previews:{}}},methods:{edit(e){this.visible=!0,this.id=e},close(){this.id=null,this.visible=!1},cancelHandel(){this.close()},changeScale(e){e=e||1,this.$refs.cropper.changeScale(e)},rotateLeft(){this.$refs.cropper.rotateLeft()},rotateRight(){this.$refs.cropper.rotateRight()},beforeUpload(e){const o=new FileReader;return o.readAsDataURL(e),o.onload=()=>{this.options.img=o.result},!1},finish(e){const o=this,a=new FormData;"blob"===e?this.$refs.cropper.getCropBlob((e=>{const t=window.URL.createObjectURL(e);this.model=!0,this.modelSrc=t;const i=new window.File([e],"avatar.jpg",{type:e.type});a.append("file",i),b.post(L+"api/v1/file/upload",a).then((e=>{this.options.upLoadedAvatar=e,o.$emit("ok",e),o.visible=!1}))})):this.$refs.cropper.getCropData((e=>{this.model=!0,this.modelSrc=e}))},okHandel(){const e=this;e.confirmLoading=!0,setTimeout((()=>{e.confirmLoading=!1,e.close(),e.$message.success("上传头像成功")}),2e3)},realTime(e){this.previews=e}}};const w={class:"mask"},x=["src"],k={class:"avatar-upload-preview"},U=["src"],A=(e=>(v("data-v-34404592"),e=e(),C(),e))((()=>n("br",null,null,-1)));var R=t(_,[["render",function(e,o,a,t,v,C){const b=i("CloudUploadOutlined"),L=i("PlusOutlined"),_=i("vue-cropper"),R=c,y=f,H=h,j=m,S=g;return s(),l("section",null,[n("div",{class:"ant-upload-preview",onClick:o[0]||(o[0]=e=>C.edit(1))},[r(b,{class:"upload-icon"}),n("div",w,[r(L)]),n("img",{src:v.options.upLoadedAvatar},null,8,x)]),r(S,{title:"修改头像",visible:v.visible,maskClosable:!1,confirmLoading:v.confirmLoading,width:800,footer:null,onCancel:C.cancelHandel},{default:d((()=>[r(y,null,{default:d((()=>[r(R,{xs:24,md:12,style:{height:"350px"}},{default:d((()=>[r(_,{ref:"cropper",img:v.options.img,info:!0,autoCrop:v.options.autoCrop,autoCropWidth:v.options.autoCropWidth,autoCropHeight:v.options.autoCropHeight,fixedBox:v.options.fixedBox,onRealTime:C.realTime},null,8,["img","autoCrop","autoCropWidth","autoCropHeight","fixedBox","onRealTime"])])),_:1}),r(R,{xs:24,md:12,style:{height:"350px"}},{default:d((()=>[n("div",k,[n("img",{src:v.previews.url,style:p(v.previews.img)},null,12,U)])])),_:1})])),_:1}),A,r(y,null,{default:d((()=>[r(R,{lg:2,md:2},{default:d((()=>[r(j,{name:"file",beforeUpload:C.beforeUpload,showUploadList:!1},{default:d((()=>[r(H,{icon:"upload"},{default:d((()=>[u("选择图片")])),_:1})])),_:1},8,["beforeUpload"])])),_:1}),r(R,{lg:{span:1,offset:2},md:2},{default:d((()=>[r(H,{icon:"plus",onClick:o[1]||(o[1]=e=>C.changeScale(1))})])),_:1}),r(R,{lg:{span:1,offset:1},md:2},{default:d((()=>[r(H,{icon:"minus",onClick:o[2]||(o[2]=e=>C.changeScale(-1))})])),_:1}),r(R,{lg:{span:1,offset:1},md:2},{default:d((()=>[r(H,{icon:"undo",onClick:C.rotateLeft},null,8,["onClick"])])),_:1}),r(R,{lg:{span:1,offset:1},md:2},{default:d((()=>[r(H,{icon:"redo",onClick:C.rotateRight},null,8,["onClick"])])),_:1}),r(R,{lg:{span:2,offset:6},md:2},{default:d((()=>[r(H,{type:"primary",onClick:o[3]||(o[3]=e=>C.finish("blob"))},{default:d((()=>[u("保存")])),_:1})])),_:1})])),_:1})])),_:1},8,["visible","confirmLoading","onCancel"])])}],["__scopeId","data-v-34404592"]]);export{R as default};
