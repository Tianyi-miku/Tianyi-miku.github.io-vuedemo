import{bL as a,_ as t,o as e,a as l,b as r}from"./vendors-a4d7b1d1.js";const o={class:"content"},s={class:"neirong"},n={class:"legend"},i={ref:"legend"},d={ref:"waterFall"},f={ref:"tip",class:"tip"};var h=t({name:"index",data:()=>({colormap:[],legend:null,waterFall:null,waterFallList:[],waterFallIndex:0,waterFallCopyList:[],waterFallIntervals:null,waterFallWidth:0,waterFallHeight:0,maxNum:10,minNum:0}),mounted(){let a=this;a.setColormap(),a.createLegendCanvas(),a.queryChartList()},destroyed(){clearInterval(this.waterFallIntervals)},methods:{setColormap(){this.colormap=a({colormap:"jet",nshades:150,format:"rba",alpha:1})},createLegendCanvas(){let a=this,t=a.$refs.legend;a.legend=t.getContext("2d");let e=document.createElement("canvas");e.width=1;let l=e.getContext("2d");const r=l.createImageData(1,a.colormap.length);for(let o=0;o<a.colormap.length;o++){const t=a.colormap[o];r.data[r.data.length-4*o+0]=t[0],r.data[r.data.length-4*o+1]=t[1],r.data[r.data.length-4*o+2]=t[2],r.data[r.data.length-4*o+3]=255}l.putImageData(r,0,0),a.legend.drawImage(l.canvas,0,0,1,a.colormap.length,50,0,200,a.legend.canvas.height)},createWaterFallCanvas(){let a=this,t=a.$refs.waterFall;a.waterFall=t.getContext("2d"),t.width=a.waterFallWidth,t.height=a.$refs.waterFallContent.offsetHeight},rowToImageData(a){let t=this;if(void 0!==t.$refs.waterFallContent){let e=Math.floor(t.$refs.waterFallContent.offsetHeight/t.waterFallHeight),l=t.waterFall.getImageData(0,0,t.waterFallWidth,e*t.waterFallIndex+1);const r=t.waterFall.createImageData(a.length,1);for(let o=0;o<r.data.length;o+=4){const e=t.colorMapData(a[o/4],0,130),l=t.colormap[e];r.data[o+0]=l[0],r.data[o+1]=l[1],r.data[o+2]=l[2],r.data[o+3]=255}for(let a=0;a<e;a++)t.waterFall.putImageData(r,0,a);t.waterFall.putImageData(l,0,e)}},colorMapData(a,t,e){let l=this;return a<=l.minNum?t:a>=l.maxNum?e:Math.round((a-l.minNum)/(l.maxNum-l.minNum)*e)},waterFallMove(a){let t=this,e=(t.$refs.waterFallContent.offsetWidth/t.waterFallWidth).toFixed(2),l=(t.$refs.waterFallContent.offsetHeight/t.waterFallHeight).toFixed(2),r=Math.floor(a.offsetX/e),o=Math.floor(a.offsetY/l);try{t.$refs.tip.innerHTML="数值："+JSON.parse(JSON.stringify(t.waterFallCopyList[o][r]));let e=a.offsetX+5,l=a.offsetY-20;a.offsetX>1300&&(e=a.offsetX-160,l=a.offsetY-20),t.$refs.tip.style.position="absolute",t.$refs.tip.style.left=e+"px",t.$refs.tip.style.top=l+"px",t.$refs.tip.style.display="block"}catch(s){t.$refs.tip.style.display="none"}},waterFallLeave(){this.$refs.tip.style.display="none"},queryChartList(){let a=this;a.waterFallWidth=1500,a.waterFallHeight=30;let t=[];for(let e=0;e<1500;e++)t.push(Math.floor(19*Math.random())+1);null===a.waterFall&&a.createWaterFallCanvas(t.length),a.rowToImageData(t),a.waterFallCopyList.unshift(t),a.waterFallIndex++,a.waterFallIndex>a.waterFallHeight&&a.waterFallCopyList.pop(),a.waterFallIntervals=setTimeout((()=>{a.queryChartList()}),1e3)}}},[["render",function(a,t,h,w,F,g){return e(),l("div",null,[r("div",o,[r("div",s,[r("div",n,[r("canvas",i,null,512)]),r("div",{class:"waterFall",ref:"waterFallContent",onMousemove:t[0]||(t[0]=a=>g.waterFallMove(a)),onMouseleave:t[1]||(t[1]=(...a)=>g.waterFallLeave&&g.waterFallLeave(...a))},[r("canvas",d,null,512),r("div",f,null,512)],544)])])])}],["__scopeId","data-v-05ee4a98"]]);export{h as default};
